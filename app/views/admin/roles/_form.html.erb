<%= form_for @role, url: @role.new_record? ? admin_roles_path : admin_role_path(@role), validate: true, html: {class: 'form'} do |f| %>
<div class="modal-body">
  <div class="col-xs-12">
    <div class="form-group">
      <label class="control-label">角色名称<span class="required-star">*</span></label>
      <div class="clearfix">
        <%= f.text_field :name, maxlength: 30, class: "col-xs-12" %>
      </div>
    </div>

    <div class="form-group">
      <label class="control-label">角色权限<span class="required-star">*</span></label>
      <div class="clearfix">
        <p><label><input type='checkbox' class='toggle' /> 全选/反选</label></p>
        <%= hidden_field_tag 'role[permission_ids][]', '' %>
        <% Permission.all.each do |permission| %>
          <label style="width: 45%;">
            <%= check_box_tag 'role[permission_ids][]', permission.id, @role.role_permission_maps.map{|m| m.permission_id}.include?(permission.id) %>
            <%= permission.name %>
          </label>
        <% end %>
      </div>
    </div>

  </div>
</div>
<div class="clearfix"></div>
<div class="modal-footer">
  <button type="submit" class="btn btn-sm btn-primary form-submit" data-fn="submit">确定</button>
  <button type="button" class="btn btn-sm btn-default" data-dismiss="modals">取消</button>
</div>
<% end %>

<script type="text/javascript">
  $(document).ready(function() {

    // toggle checkbox
    // <label><input type='checkbox' class='checkbox toggle' />全选/反选</label>
    $(':checkbox.toggle').on('click', function() {
      $(":checkbox:not(.toggle)").each( function(i, checkbox) {
        checkbox.checked = !checkbox.checked;
      });
    });

  });
</script>